<!DOCTYPE html>
<html lang="hy">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>’ç’ø’•’Ø’´ ‘π’•’Ω’ø | AlgoLearn</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      padding: 20px;
      color: #333;
    }

    .quiz-container {
      max-width: 800px;
      margin: 0 auto;
      background: #fff;
      padding: 30px 40px;
      border-radius: 6px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    h1 {
      text-align: center;
      font-size: 1.6rem;
      margin-bottom: 30px;
    }

    .question-block {
      margin-bottom: 30px;
    }

    h2 {
      font-size: 1.1rem;
      margin-bottom: 12px;
    }

    ul {
      list-style: none;
      padding-left: 0;
    }

    li {
      margin-bottom: 8px;
    }

    input[type="radio"] {
      margin-right: 10px;
    }

    input[type="text"] {
      width: 100%;
      padding: 8px;
      font-size: 1rem;
      border-radius: 4px;
      border: 1px solid #ccc;
      margin-top: 10px;
    }

    .code-snippet {
      background-color: #f9f9f9;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 10px;
      font-family: Consolas, monospace;
      white-space: pre-wrap;
    }

    .check-btn {
      display: block;
      margin: 30px auto 0;
      padding: 10px 25px;
      background-color: #6f42c1;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
    }

    .check-btn:hover {
      background-color: #5f38a9;
    }

    .result-message {
      margin-top: 10px;
      font-style: italic;
      font-size: 0.95rem;
    }

    .correct-answer {
      color: green;
      font-weight: bold;
    }

    .wrong-answer {
      color: red;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div class="quiz-container">
    <h1>’ç’ø’•’Ø’´ ‘π’•’Ω’ø</h1>
    <div id="quiz"></div>
    <button class="check-btn" onclick="submitQuiz()">’ç’ø’∏÷Ç’£’•’¨ ’∫’°’ø’°’Ω’≠’°’∂’∂’•÷Ä’®</button>
  </div>

  <script>
    const topic = "Stack";
    const API_URL = "https://localhost:7045/api/quiz/submit";
    const COMPLETE_URL = "https://localhost:7045/api/dashboard/complete";

    const questions = [
      {
        id: 1, text: "’à’û÷Ä ’ø’æ’µ’°’¨’∂’•÷Ä’´ ’Ø’°’º’∏÷Ç÷Å’æ’°’Æ÷Ñ’∂ ’ß ÷Ö’£’ø’°’£’∏÷Ä’Æ’æ’∏÷Ç’¥ ÷Ü’∏÷Ç’∂’Ø÷Å’´’°’∂’•÷Ä’´ ’Ø’°’∂’π’•÷Ä’´ ’´÷Ä’°’Ø’°’∂’°÷Å’¥’°’∂ ’∞’°’¥’°÷Ä ’∑’°’ø ’Æ÷Ä’°’£÷Ä’°’æ’∏÷Ä’¥’°’∂ ’¨’•’¶’∏÷Ç’∂’•÷Ä’∏÷Ç’¥:",
        type: "multiple",
        choices: ["’Ä’•÷Ä’© (Queue)", "’ç’ø’•’Ø (Stack)", "‘ø’°’∫’°’Ø÷Å’æ’°’Æ ÷Å’∏÷Ç÷Å’°’Ø (Linked List)", "‘æ’°’º (Tree)"]
      },
      {
        id: 2, text: "‘ª’û’∂’π ’™’°’¥’°’∂’°’Ø’°’µ’´’∂ ’¢’°÷Ä’§’∏÷Ç’©’µ’∏÷Ç’∂ ’∏÷Ç’∂’•’∂ push() ÷á pop() ’£’∏÷Ä’Æ’∏’≤’∏÷Ç’©’µ’∏÷Ç’∂’∂’•÷Ä’® ’Ω’ø’•’Ø’∏÷Ç’¥:",
        type: "multiple",
        choices: ["O(1)", "O(n)", "O(log n)", "O(n¬≤)"]
      },
      {
        id: 3, text: "’à’û÷Ä’∂ ’ß ’£’∏÷Ä’Æ’∏’≤’∏÷Ç’©’µ’∏÷Ç’∂’∂’•÷Ä’´ ’∞’•÷Ä’©’°’Ø’°’∂’∏÷Ç’©’µ’∏÷Ç’∂’® ’Ω’ø’•’Ø’∏÷Ç’¥:",
        type: "multiple",
        choices: ["FIFO", "LILO", "LIFO", "FILO"]
      },
      {
        id: 4, text: "‘ª’û’∂’π ’Ø’∫’°’ø’°’∞’´, ’•’©’• ÷É’∏÷Ä’±’•÷Ñ pop ’°’∂’•’¨ ’§’°’ø’°÷Ä’Ø ’Ω’ø’•’Ø’´÷Å:",
        type: "multiple",
        choices: ["Stack Overflow", "Null Reference Exception", "Stack Underflow", "Segmentation Fault"]
      },
      {
        id: 5, text: "‘º÷Ä’°÷Å÷Ä’∏÷Ç ’¢’°÷Å’°’Ø’°’µ’∏’≤ ’¥’°’Ω’® ’Ω’ø’•’Ø’´ push() ÷Ü’∏÷Ç’∂’Ø÷Å’´’°’µ’´ ’∫’Ω÷á’§’∏’Ø’∏’§’∏÷Ç’¥‚Ä§",
        code: `Procedure Push(data):
  If top = maxSize - 1:
    Throw "Stack Overflow"
  _______
  stack[top + 1] ‚Üê data`,
        type: "regex",
        answer: "/^top\s*[‚Üê=]\s*top\s*\+\s*1;?$/i"
      },
      {
        id: 6, text: "’ç’ø’•’Ø’•÷Ä’® ’´÷Ä’°’Ø’°’∂’°÷Å’æ’∏÷Ç’¥ ’•’∂ ÷á’õ ’¶’°’∂’£’æ’°’Æ’∂’•÷Ä’´, ÷á’õ ’Ø’°’∫’°’Ø÷Å’æ’°’Æ ÷Å’∏÷Ç÷Å’°’Ø’∂’•÷Ä’´ ’¥’´’ª’∏÷Å’∏’æ÷â",
        type: "multiple",
        choices: ["’É’´’∑’ø", "’ç’≠’°’¨"]
      },
      {
        id: 7, text: "’à÷Ä÷Ñ’°’û’∂ ’ß n ’π’°÷É’´ ’¶’°’∂’£’æ’°’Æ’∏’æ ’´÷Ä’°’Ø’°’∂’°÷Å’æ’°’Æ ’Ω’ø’•’Ø’´ ’ø’°÷Ä’°’Æ÷Ñ’°’µ’´’∂ ’¢’°÷Ä’§’∏÷Ç’©’µ’∏÷Ç’∂’®:",
        type: "multiple",
        choices: ["O(1)", "O(n)", "O(n log n)", "O(n¬≤)"]
      },
      {
        id: 8, text: "‘º÷Ä’°÷Å÷Ä’∏÷Ç ’¢’°÷Å’°’Ø’°’µ’∏’≤ ’¥’°’Ω’® ’Ω’ø’•’Ø’´ pop() ÷Ü’∏÷Ç’∂’Ø÷Å’´’°’µ’´ ’∫’Ω÷á’§’∏’Ø’∏’§’∏÷Ç’¥‚Ä§",
        code: `Procedure Pop():
  If top < 0:
    Throw "Stack Underflow"
  value ‚Üê stack[top]
  _______
  Return value`,
        type: "regex",
        answer: "/^top\s*[‚Üê=]\s*top\s*-\s*1;?$/i"
      },
      {
        id: 9, text: "‘ª’û’∂’π ’ø’´’∫’´ ’≠’∂’§’´÷Ä ’ß ’°÷Ä’§’µ’∏÷Ç’∂’°’æ’•’ø ’¨’∏÷Ç’Æ’æ’∏÷Ç’¥ ’Ω’ø’•’Ø’´ ÷Ö’£’ø’°’£’∏÷Ä’Æ’¥’°’¥’¢:",
        type: "multiple",
        choices: [
          "‘µ÷Ä’Ø’∏÷Ç’°’Ø’°’∂ ’∏÷Ä’∏’∂’∏÷Ç’¥ (Binary Search)",
          "‘ª’∂÷Ü’´÷Ñ’Ω’´÷Å ’∫’∏’Ω’ø÷Ü’´÷Ñ’Ω’´ ÷É’∏’≠’°’Ø’•÷Ä’∫’∏÷Ç’¥",
          "‘±’¥’•’∂’°’Ø’°÷Ä’≥ ’∏÷Ç’≤’´ (Shortest Path)",
          "’Ä’•’∑’°’æ’∏÷Ä’∏÷Ç’¥ (Hashing)"
        ]
      },
      {
        id: 10, text: "‘ª’û’∂’π ’ß ’ø’•’≤’´ ’∏÷Ç’∂’•’∂’∏÷Ç’¥, ’•÷Ä’¢ ÷É’∏÷Ä’±’∏÷Ç’¥ ’•÷Ñ push ’°’∂’•’¨ ’ø’°÷Ä÷Ä’® ’¨’´÷Ñ’® ’Ω’ø’•’Ø’´ ’¥’•’ª÷â",
        type: "regex",
        answer: /(Stack Overflow|’Ω’ø’•’Ø’´\s*(’£’•)?’¨÷Å’∏÷Ç’¥)/i
      }
    ];

    const correct = {
      1: "2", 2: "1", 3: "3", 4: "3",
      5: /^top\s*[‚Üê=]\s*top\s*\+\s*1;?$/i, 6: "1", 7: "2", 8: /^top\s*[‚Üê=]\s*top\s*-\s*1;?$/i, 9: "2",
      10: new RegExp(/(Stack Overflow|’Ω’ø’•’Ø’´\s*(’£’•)?’¨÷Å’∏÷Ç’¥)/)
    };

    const quizEl = document.getElementById("quiz");

    questions.forEach(q => {
      const block = document.createElement("div");
      block.className = "question-block";

      const h2 = document.createElement("h2");
      h2.textContent = `${q.id}. ${q.text}`;
      block.appendChild(h2);

      if (q.code) {
        const codeBox = document.createElement("div");
        codeBox.className = "code-snippet";
        codeBox.textContent = q.code;
        block.appendChild(codeBox);
      }

      if (q.type === "multiple") {
        const ul = document.createElement("ul");
        q.choices.forEach((choice, index) => {
          const li = document.createElement("li");
          li.innerHTML = `<label><input type="radio" name="q${q.id}" value="${index + 1}"> ${choice}</label>`;
          ul.appendChild(li);
        });
        block.appendChild(ul);
      } else {
        const input = document.createElement("input");
        input.type = "text";
        input.placeholder = "’î’∏ ’∫’°’ø’°’Ω’≠’°’∂’®...";
        input.id = `q${q.id}-answer`;
        block.appendChild(input);
      }

      const result = document.createElement("p");
      result.id = `result-q${q.id}`;
      result.className = "result-message";
      block.appendChild(result);

      quizEl.appendChild(block);
    });

    async function submitQuiz() {
      const email = localStorage.getItem("userEmail");
      if (!email) return alert("’Ñ’∏÷Ç’ø÷Ñ ’£’∏÷Ä’Æ’•÷Ñ ’∂’°’≠÷Ñ’°’∂ ’©’•’Ω’ø’® ’∞’°’∂’±’∂’•’¨’®÷â");

      let correctCount = 0;
      const answers = [];
      
      
      for (let q of questions) {
        let userAnswer = "";
        const result = document.getElementById(`result-q${q.id}`);

        if (q.type === "multiple") {
          const selected = document.querySelector(`input[name="q${q.id}"]:checked`);
          if (selected) userAnswer = selected.value;
        } else {
          const input = document.getElementById(`q${q.id}-answer`);
          userAnswer = input ? input.value.trim() : "";
        }

        let isCorrect = false;
        console.log("Q" + q.id, "User answer:", userAnswer);
        console.log("Correct pattern:", correct[q.id]);

        if (correct[q.id] instanceof RegExp) {
          isCorrect = correct[q.id].test(userAnswer);
        } else {
          isCorrect = userAnswer === correct[q.id];
        }

        result.textContent = isCorrect ? "‚úîÔ∏è ’É’´’∑’ø ’ß" : "‚ùå ’ç’≠’°’¨ ’ß";
        result.className = "result-message " + (isCorrect ? "correct-answer" : "wrong-answer");

        if (isCorrect) correctCount++;
        answers.push({ questionId: q.id, answer: userAnswer });
      }

      const res = await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ topic, userEmail: email, answers })
      });

      const result = await res.json();
      if (result.canComplete) {
        alert("üéâ ’á’∂’∏÷Ä’∞’°’æ’∏÷Ä’°’∂÷Ñ’∂’•÷Ä, ’§’∏÷Ç÷Ñ ’∞’°’ª’∏’≤’∏÷Ç’©’µ’°’¥’¢ ’°’∂÷Å’°÷Ñ ’©’•’Ω’ø’®÷â");

        await fetch(COMPLETE_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, topicName: topic })
        });
      } else {
        alert("üìö ‘¥’∏÷Ç÷Ñ ’Ω’≠’°’¨ ’•÷Ñ ’∫’°’ø’°’Ω’≠’°’∂’•’¨ ’¥’´ ÷Ñ’°’∂’´ ’∞’°÷Ä÷Å’´÷â ‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’æ’•÷Ä’°’∂’°’µ’•’¨ ’∂’µ’∏÷Ç’©’® ÷á ÷É’∏÷Ä’±’•’¨ ’∂’∏÷Ä’´÷Å÷â");
      }
    }
  </script>
</body>

</html>